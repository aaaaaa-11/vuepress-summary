# 栈内存与堆内存
内存会被划分为栈、堆、静态存储区、程序代码取等
- 栈空间较小，会存储一些函数运行时产生的临时变量等，发生溢出时会报错（StackOverFlowError）
- 堆相对较大，主要存放一些通过new出来的对象或malloc申请的内存空间
- 静态存储区在程序编译的时候就已经分配好，在整个程序运行过程中都存在，主要存放静态数据、全局数据和常量
- 程序代码区主要用于存放程序的二进制代码空间


|  | 栈内存 | 堆内存 |
| --- | ---- | --- |
| 内存分配与释放 | 分配的内存空间是连续的，编译器自动分配与回收 | 分配的内存空间是不连续的，手动申请和释放 |
| 成本 | 较小 | 较大 |
| 操作 | 简单 | 更难 |
| 访问时间 | 快 | 慢（因为不连续） |
| 主要问题 | 内存不足 | 内存碎片 |
| 安全性 | 线程安全，存储的数据只能由所有者访问 | 非线程安全的，存储的数据对所有线程可见 |
| 灵活性 | 尺寸固定 | 可以调整大小 |
| 数据类型结构 | 线性 | 分层的 |
| 申请 | 从静态内存中分配 | 在链表中分配堆内存 |
| 尺寸 | 小于堆内存 | 大于栈内存 |


解释：

栈内存：分配连续的内存空间，每次发生在函数调用时，其变量都会被分配栈内存，当函数调用结束时，释放变量内存，这些都是编译器自动执行。这种临时内存分配的方案，只有在函数运行时才能访问。当栈内存已满，会报错（StackOverFlowError）。这种内存申请和回收更快，且占用空间更小。

堆内存：在执行程序时，右程序员手动分配和释放的内存空间，当创建对象时，对象的引用信息会存放在堆内存中，对所有线程可访问，所以不如栈内存安全。如果程序员没有释放该内存，就会发生内存泄漏。如果堆内存已满，也会收到错误信息。与栈内存相比，堆内存的处理时间（访问时间）较慢，大小远大于栈内存，整个应用程序运行过程中堆内存都可以访问/存在。

栈内存更容易发生内存短缺的问题，而堆内存的主要问题是碎片化。

[参考](https://www.geeksforgeeks.org/stack-vs-heap-memory-allocation/)